<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>অ্যাডমিন ড্যাশবোর্ড</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600&display=swap');
        body { font-family: 'Hind Siliguri', sans-serif; margin: 0; background-color: #f4f6f8; }
        .container { max-width: 1100px; margin: 20px auto; padding: 20px; }
        h1, h2 { color: #4a148c; }
        .card { background-color: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); margin-bottom: 25px; }
        input[type="text"], input[type="email"], input[type="password"], textarea { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; font-size: 16px; font-family: 'Hind Siliguri', sans-serif; }
        textarea { resize: vertical; min-height: 150px; }
        button { background-color: #4a148c; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; font-weight: 600; transition: background-color 0.2s; }
        button:hover { background-color: #380f6b; }
        #login-view { max-width: 400px; margin: 50px auto; }
        #dashboard-view { display: none; }
        #logout-btn { background-color: #e53935; float: right; }
        .product-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .product-table th, .product-table td { text-align: left; padding: 12px; border-bottom: 1px solid #eee; }
        .product-table th { background-color: #f9f9f9; }
        .actions button { margin-left: 8px; padding: 6px 12px; font-size: 14px; }
        .btn-edit { background-color: #1e88e5; }
        .btn-delete { background-color: #e53935; }
    </style>
</head>
<body>

    <div class="container">
        <!-- Login View -->
        <div id="login-view" class="card">
            <h1>অ্যাডমিন লগইন</h1>
            <form id="login-form">
                <input type="email" id="login-email" placeholder="অ্যাডমিন ইমেল" required>
                <input type="password" id="login-password" placeholder="পাসওয়ার্ড" required>
                <button type="submit">লগইন</button>
                <p id="login-error" style="color: red;"></p>
            </form>
        </div>

        <!-- Dashboard View -->
        <div id="dashboard-view">
            <button id="logout-btn">লগ আউট</button>
            <h1>প্রোডাক্ট ম্যানেজমেন্ট</h1>
            
            <div class="card">
                <h2 id="form-title">নতুন প্রোডাক্ট যোগ করুন</h2>
                <form id="lyrics-form">
                    <input type="hidden" id="lyrics-key">
                    <input type="text" id="lyrics-title" placeholder="প্রোডাক্টের নাম (গানের শিরোনাম)" required>
                    <input type="text" id="lyrics-artist" placeholder="ব্র্যান্ড (শিল্পীর নাম)" required>
                    <input type="text" id="lyrics-category" placeholder="ক্যাটাগরি (যেমন: ফোক, পপ, আধুনিক)" required>
                    <textarea id="lyrics-content" placeholder="প্রোডাক্টের বিবরণ (গানের লিরিক্স)" required></textarea>
                    <input type="text" id="youtube-link" placeholder="সম্পূর্ণ ইউটিউব ভিডিও লিংক" required>
                    <br><br>
                    <button type="submit" id="save-btn">পাবলিশ করুন</button>
                    <button type="button" id="cancel-edit" style="display:none; background-color: #6c757d;">বাতিল</button>
                </form>
            </div>
            
            <div class="card">
                <h2>সকল প্রোডাক্টের তালিকা</h2>
                <table class="product-table">
                    <thead><tr><th>প্রোডাক্টের নাম</th><th>ক্যাটাগরি</th><th>অ্যাকশন</th></tr></thead>
                    <tbody id="manage-list"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // আপনার Firebase প্রজেক্টের কনফিগারেশন এখানে যুক্ত করুন
        const firebaseConfig = {
  apiKey: "AIzaSyAvGLLgml7Ww5gp79G__VpzEdLpkQ0CNQQ",
  authDomain: "lyrics-9c74b.firebaseapp.com",
  databaseURL: "https://lyrics-9c74b-default-rtdb.firebaseio.com",
  projectId: "lyrics-9c74b",
  storageBucket: "lyrics-9c74b.firebasestorage.app",
  messagingSenderId: "1036099155076",
  appId: "1:1036099155076:web:baa27015d24cc49bc7bed1",
  measurementId: "G-YPQQ6E3YVR"
};

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();
        const lyricsRef = database.ref('lyrics');

        // DOM Elements
        const loginView = document.getElementById('login-view');
        const dashboardView = document.getElementById('dashboard-view');
        const loginForm = document.getElementById('login-form');
        const logoutBtn = document.getElementById('logout-btn');
        const lyricsForm = document.getElementById('lyrics-form');
        const manageList = document.getElementById('manage-list');
        const formTitle = document.getElementById('form-title');
        const cancelEditBtn = document.getElementById('cancel-edit');
        const saveBtn = document.getElementById('save-btn');

        auth.onAuthStateChanged(user => {
            if (user) {
                loginView.style.display = 'none';
                dashboardView.style.display = 'block';
                loadProducts();
            } else {
                loginView.style.display = 'block';
                dashboardView.style.display = 'none';
            }
        });

        loginForm.addEventListener('submit', e => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            auth.signInWithEmailAndPassword(email, password).catch(err => alert("লগইন তথ্য ভুল।"));
        });

        logoutBtn.addEventListener('click', () => auth.signOut());

        lyricsForm.addEventListener('submit', e => {
            e.preventDefault();
            const title = document.getElementById('lyrics-title').value;
            const artist = document.getElementById('lyrics-artist').value;
            const category = document.getElementById('lyrics-category').value;
            const lyrics = document.getElementById('lyrics-content').value;
            const videoLink = document.getElementById('youtube-link').value;
            const key = document.getElementById('lyrics-key').value;

            const songData = { title, artist, category, lyrics, videoLink, timestamp: Date.now() };

            const promise = key ? lyricsRef.child(key).update(songData) : lyricsRef.push(songData);
            promise.then(() => {
                resetForm();
            }).catch(err => console.error(err));
        });

        function loadProducts() {
            lyricsRef.orderByChild('timestamp').on('value', snapshot => {
                manageList.innerHTML = '';
                const data = snapshot.val();
                if (data) {
                    const sortedKeys = Object.keys(data).reverse();
                    for (const key of sortedKeys) {
                        const song = data[key];
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td><strong>${song.title}</strong><br><small>${song.artist}</small></td>
                            <td>${song.category}</td>
                            <td class="actions">
                                <button class="btn-edit" onclick="editProduct('${key}')">এডিট</button>
                                <button class="btn-delete" onclick="deleteProduct('${key}')">ডিলিট</button>
                            </td>`;
                        manageList.appendChild(row);
                    }
                }
            });
        }
        
        window.editProduct = key => {
            database.ref('lyrics/' + key).once('value').then(snapshot => {
                const song = snapshot.val();
                document.getElementById('lyrics-key').value = key;
                document.getElementById('lyrics-title').value = song.title;
                document.getElementById('lyrics-artist').value = song.artist;
                document.getElementById('lyrics-category').value = song.category;
                document.getElementById('lyrics-content').value = song.lyrics;
                document.getElementById('youtube-link').value = song.videoLink || '';
                formTitle.innerText = "প্রোডাক্ট এডিট করুন";
                cancelEditBtn.style.display = 'inline-block';
                saveBtn.textContent = 'আপডেট করুন';
                window.scrollTo(0, 0);
            });
        };
        
        window.deleteProduct = key => {
            if (confirm("আপনি কি নিশ্চিতভাবে এই প্রোডাক্টটি ডিলিট করতে চান?")) {
                lyricsRef.child(key).remove();
            }
        };
        
        function resetForm() {
            lyricsForm.reset();
            document.getElementById('lyrics-key').value = '';
            formTitle.innerText = "নতুন প্রোডাক্ট যোগ করুন";
            cancelEditBtn.style.display = 'none';
            saveBtn.textContent = 'পাবলিশ করুন';
        }

        cancelEditBtn.addEventListener('click', resetForm);
    </script>
</body>
</html>